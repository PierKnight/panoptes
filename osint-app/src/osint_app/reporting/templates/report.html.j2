<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OSINT Report – {{ domain }}</title>
</head>
<body>
<div class="section">
    <h1>OSINT Report – {{ domain }}</h1>
    <p><em>Run: {{ run_datetime }}</em></p>
</div>

<div class="section">
    <h2>Summary</h2>
    <p><strong>Open Source Intelligence (<em>OSINT</em>)</strong>, or <em>Intelligence from Open Sources</em>, is a discipline focused on the <strong>research</strong>, <strong>collection</strong>, and <strong>analysis</strong> of relevant information from publicly accessible sources. These <strong>data</strong>, often available in an <em>unstructured format</em>, are analyzed and correlated to gain a <strong>comprehensive understanding</strong> of the context of interest. In the realm of <strong>OSINT investigations</strong>, significant attention is given to the use of <em>automated techniques</em> to gather data from a wide range of sources, followed by a thorough manual analysis phase aimed at simulating the perspective of a potential <strong>attacker</strong> on the target.</p>
</div>

<div class="section">
    <h2>Introduction</h2>
</div>

<div class="section">
    <h2>Process</h2>
</div>

<div class="section">
    <h2>Retrieved Info Summary</h2>
</div>

<div class="section">
    <h2>Investigation</h2>
    <p>
        In this chapter, we delve into the information-gathering process conducted on the web infrastructure of 
        {% if web_domain %}{{web_domain}}{% else %}{{domain}}{% endif %}.
        It's important to note that while a multitude of data sources were queried, only those providing relevant information with potential use for malicious actors are highlighted here.
    </p>
</div>

<div class="section">
    <h2 id="domain">Domain</h2>
    <h3>DNS Records</h3>
    <p>
        Another important source of information for domain analysis is represented by <strong>DNS records</strong>.  
        These records provide essential technical details, such as the <strong>IP addresses</strong> associated with the domain (<strong>A</strong> and <strong>AAAA</strong> records), <strong>mail servers</strong> (<strong>MX</strong>), <strong>name servers</strong> (<strong>NS</strong>), and other key configurations like <strong>CNAME</strong> and <strong>TXT records</strong>.  
        By analyzing <strong>DNS records</strong>, it is possible to gain an in-depth understanding of the domain’s configuration and its underlying <strong>technical infrastructure</strong>, helping to identify potential <strong>points of interest</strong> or <strong>vulnerabilities</strong>.
    </p>

    {% for record_type, content in dns_records.items() %}
        <h4>{{ record_type.upper() }} Records</h4>
        {% if content|length == 0 %}
            <p>No {{ record_type }} records found for <strong>{{ domain }}</strong>.</p>
        {% else %}
            {% if record_type == 'txt' %}
                {% for txt_record in content %}
                    <div><code>{{ txt_record }}</code></div>
                {% endfor %}
            {% else %}
                <table class="record-table">
                    {% if loop.first %}
                        <tr>
                            <th>Host</th>
                            <th>IP Address</th>
                            <th>ASN</th>
                            <th>ASN Name</th>
                        </tr>
                    {% endif %}
                    {% for record in content %}
                        <tr>
                            <td><code>{{ record.host }}</code></td>
                            <td>{{ record.ips[0].ip if record.ips else 'N/A' }}</td>
                            <td>{{ record.ips[0].asn if record.ips else 'N/A' }}</td>
                            <td>{{ record.ips[0].asn_name if record.ips else 'N/A' }}</td>
                        </tr>
                    {% endfor %}
                </table>
            {% endif %}
        {% endif %}
    {% endfor %}
</div>

<div class="section">
    <h3>SPF & DMARC</h3>
    <p>
        Another useful check is the analysis of <strong>DMARC</strong> and <strong>SPF</strong> records. These email authentication mechanisms are <strong>essential</strong> for protecting a domain from <strong>abuse</strong> and <strong>phishing</strong> attacks. DMARC (<em>Domain-based Message Authentication, Reporting, and Conformance</em>) allows domain owners to specify how emails <em>failing authentication checks</em> should be handled, and provides detailed reports on unauthorized use attempts. On the other hand, SPF (Sender Policy Framework) defines <em>which servers are authorized to send emails</em> on behalf of the domain.
    </p>

    <h4>DMARC</h4>
    <img src="{{ images.dmarc }}" alt="DMARC Info" style="max-width: 80%; height: auto;">

    <h4>SPF</h4>
    <img src="{{ images.spf }}" alt="SPF Info" style="max-width: 80%; height: auto;">
</div>

<div class="section">
    <h3>SSL Check</h3>
    <p>
        SSL/TLS certificates are another crucial component in assessing a domain's security and reliability. They ensure that communications between the website and its users are <strong>encrypted</strong> and <strong>secure</strong>. Analyzing these certificates allows verification of their <strong>validity</strong>, <strong>expiration date</strong>, and the issuing <strong>certificate authority</strong>. Proper configuration can prevent <strong>man-in-the-middle attacks</strong> and ensure <strong>sensitive information</strong> is protected during transit.
    </p>
    <p>The analysis of SSL/TLS certificates includes:</p>
    <ul>
        <li><strong>Validity Check:</strong> Ensuring the certificate's expiration date is still valid.</li>
        <li><strong>Certificate Authority:</strong> Identifying the issuing authority and verifying its trustworthiness.</li>
        <li><strong>Security Configuration:</strong> Examining security settings, such as the use of strong <strong>encryption protocols</strong> and <strong>HSTS</strong> configurations.</li>
    </ul>
    <h4>Server Certificate Info</h4>
    <p>
        <strong>Common name:</strong> <code>{{ ssl_check['Common name'] }}</code><br>
        <strong>SANs:</strong> <code>{{ ssl_check['SANs']|join(', ') }}</code><br>
        <strong>Organization:</strong> {{ ssl_check['Organization'] }}<br>
        <strong>Location:</strong> {{ ssl_check['Location']|join(', ') }}<br>
        <strong>Valid from:</strong> {{ ssl_check['Valid from'] }}<br>
        <strong>Valid until:</strong> {{ ssl_check['Valid until'] }}<br>
        <strong>Serial Number:</strong> {{ ssl_check['Serial Number'] }}<br>
        <strong>Signature Algorithm:</strong> {{ ssl_check['Signature Algorithm'] }}<br>
        <strong>Issuer:</strong> {{ ssl_check['Issuer'] }}<br>
    </p>
    <h4>Certificate Chain</h4>
    <img src="{{ images.ssl_check }}" alt="SSL Chain" style="max-width: 80%; height: auto;">
</div>

<div class="section">
    <h3>Technology Stack</h3>
    <table>
        <tr>
            <th>Category</th>
            <th>Employed Tech(s)</th>
        </tr>
        {% for category, technologies in tech_stack.items() %}
            <tr>
                <td>{{ category }}</td>
                <td>
                    {% if technologies|length > 0 %}
                        {{ technologies|join('<br/>')|safe }}
                    {% else %}
                        <em>No technologies found</em>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
</div>

<div class="section">
    <h3>Header Analysis</h3>
    {% if header_analysis|length > 0 %}
        <p>The analysis of the headers revealed the absence of important security headers:</p>
        <table>
            <tr><th>Header</th><th>Description</th></tr>
            {% for header, value in header_analysis.items() %}
                <tr><td><code>{{ header }}</code></td><td>{{ value }}</td></tr>
            {% endfor %}
        </table>
    {% else %}
        <p>All important security headers are present, indicating that the web application has implemented the necessary measures to enhance its security posture.</p>
    {% endif %}
</div>

<div class="section">
    <h2>Subdomains</h2>
    <p>
        Here is a list of subdomains discovered during the investigation with respective IP addresses.<br>
        These subdomains may provide additional attack vectors or insights into the web infrastructure of <strong>{{domain}}</strong>
    </p>
    {% if subdomains_ips|length > 0 %}
        <table>
            <tr><th>Subdomain</th><th>IP Address(es)</th></tr>
            {% for subdomain, ips in subdomains_ips.items() %}
                <tr>
                    <td><code>{{ subdomain }}</code></td>
                    <td>
                        {% if ips|length > 0 %}
                            {{ ips|join("<br/>")|safe }}
                        {% else %}
                            <em>No IPs Found</em>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No subdomains were found for <strong>{{domain}}</strong>.</p>
    {% endif %}
</div>

<div class="section">
    <h2>Hosts</h2>
    <p>In this chapter, all information related to the <strong>hosts</strong> identified during the investigation is collected and analyzed. Each host represents a potential <strong>access point</strong> and a valuable <strong>source of data</strong> for better understanding the target's <strong>network</strong> and <strong>resources</strong>. This chapter provides a clear and in-depth view of each host, highlighting <strong>critical elements</strong> that could be exploited in a potential attack.</p>
    {% for ip, info in hosts.items() %}
        <table class="host-table">
            <tr class="ip-row">
                <td><code class="bold-transparent-code">{{ ip }}</code></td></tr>
                {% if info|length > 0 %}
                    {% for service in info.data %}
                        <tr class="exposed-service-row">
                            <td>              
                                <code class="bold-transparent-code">{{service['port']}}/{{service['transport']}}</strong></code><br/>         
                                {% if service['product'] or service['os'] != None %}
                                    <strong><em>Software</em></strong><br/>
                                    {% if service['product'] %}
                                        &emsp;{{service['product']}}{% if service['version'] %}/{{service['version']}}{% endif %}<br/>
                                    {% endif %}
                                    {% if service['os'] != None %}
                                        &emsp;{{service['os']}}<br/>
                                    {% endif %}
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                {% else %}

                {% endif %}
            </tr>
        
        </table>
    {% endfor %}
    
</div>
<div class="section">
    <h2>Provider Hosting</h2>
</div>
<div class="section">
    <h2>Compromised Hosts</h2>
</div>

<div class="section">
    <h2>Compromised Credentials</h2>
    <p>
        This section contains all compromised credentials identified during the OSINT investigation. Credential compromise is one of the most severe cybersecurity threats, as it can give attackers direct access to <strong>sensitive internal resources</strong>, <strong>critical systems</strong>, and <strong>confidential data</strong>. The collected information comes from <strong>known breaches</strong>, <strong>data leaks</strong>, and <strong>illicit sharing platforms</strong>, providing an overview of the risks the company might face. This analysis aims to identify potential <strong>entry points</strong> for future attacks and suggest <strong>mitigation measures</strong> to protect the integrity of the company's systems.
    </p>
    {% if leaked_credentials|length > 0 %}
        <h3>Summary of Leaked Credentials</h3>
        <table>
            <tr><th>Email</th><th>Count</th></tr>
            {% for email, leaks in leaked_credentials.items() %}
                <tr><td>{{ email }}</td><td>{{ leaks|length }}</td></tr>
            {% endfor %}
        </table>
        <h3>Leaked Credentials</h3>
        {% for email, leaks in leaked_credentials.items() %}
            <h4>{{ email }}</h4>
            <h5>Involvement in Data Breaches</h5>
            {% if data_breaches[email]|length == 0 %}
                <p>No data breaches found for <strong>{{email}}</strong> from public sources.</p>
            {% else %}
                <table>
                    <tr><th>Title</th><th>Date</th><th>Compromised Data</th></tr>
                    {% for breach in data_breaches[email] %}
                        <tr>
                            <td><strong>{{ breach.Title }}</strong></td>
                            <td>{{ breach.AddedDate }}</td>
                            <td>{{ breach.DataClasses|join(', ') }}</td>
                        </tr>
                    {% endfor %}
                </table>
            {% endif %}
            <h5>Data Leaks</h5>
            {% for leak in leaks %}
                <div><code class="data-leak">{{ leak }}</code></div>
            {% endfor %}
            <hr>
        {% endfor %}
    {% else %}
        <p>No compromised credentials were found for <strong>{{domain}}</strong>.</p>
    {% endif %}
</div>

<div class="section">
    <h2>Data Breach Details (???)</h2>
</div>

<div class="section">
    <h2>Conclusion</h2>
</div>

</body>
</html>